---
title: "From Survey to Insights: Results in Just Minutes"
title-block-banner: true
author: "Zahid Asghar"
format: 
  html:
    theme: [default, custom1.scss]
    toc: true
    toc_depth: 2
    toc_float: true
    keep-md: false
    highlight-style: dracula
execute: 
  warning: false
  message: false
  echo: false
  error: true
---

```{css}
body {
  font-size: 18px;
}

```

```{r}
# Load necessary packages
library(tidyverse)
library(googlesheets4)
library(janitor)
library(hrbrthemes)
library(gendercoder)
library(scales)
library(stringr)
library(tidygeocoder)
library(leaflet)
library(forcats)

# Authorize Google Sheets access
gs4_auth("g.zahid@gmail.com", cache = TRUE)

# Set plotting theme
theme_set(theme_ipsum(base_family = "Inter", axis_title_family = "Inter"))

# Load and clean survey data
survey_responses_today <- read_sheet("https://docs.google.com/spreadsheets/d/1MtsOv9hHglaPFocxqOMSEVvTOV9SBFanFEpeC61TtRQ/edit?resourcekey=&gid=708609323") %>% 
  clean_names() %>% 
  mutate(
    timestamp = as.Date(timestamp),
    age       = as.numeric(what_is_your_age_in_complete_years_in_digits)
  ) %>% 
  filter(timestamp == Sys.Date())
# General survey info â€” move this chunk near the top!
number_of_responses <- nrow(survey_responses_today)
today_pretty        <- format(Sys.Date(), "%B %d, %Y")

```

We conducted a **survey** on `r today_pretty`. We received responses from `r number_of_responses` people.


## Age 
```{r}
# General survey info
number_of_responses <- nrow(survey_responses_today)
today_pretty        <- format(Sys.Date(), "%B %d, %Y")

# Age stats
mean_age <- round(mean(survey_responses_today$age, na.rm = TRUE), 1)
min_age  <- min(survey_responses_today$age, na.rm = TRUE)
max_age  <- max(survey_responses_today$age, na.rm = TRUE)
```

The youngest respondent was `r min_age` years old, and the oldest was `r max_age`. The mean age was `r mean_age` years.


### Age Distribution

```{r}
# 1. Age Distribution
age_categorized <- survey_responses_today %>%
  mutate(age_category = case_when(
    age < 30  ~ "Less than 30",
    age < 50  ~ "Between 30 and 50",
    TRUE      ~ "50 or older"
  )) %>%
  count(age_category) %>%
  drop_na(age_category)

ggplot(age_categorized, aes(
    fct_rev(factor(age_category, levels = c("Less than 30", "Between 30 and 50", "50 or older"))),
    n
  )) +
  geom_col(fill = "#6CABDD") +
  geom_text(aes(label = n), hjust = 1.2, color = "white") +
  coord_flip() +
  labs(title = "Age Distribution of Respondents", x = NULL, y = "Count") +
  theme_minimal(base_family = "Inter")
```

## Education 


```{r}
# 2. Education Level
survey_responses_today %>%
  count(what_is_your_highest_qualification) %>%
  drop_na() %>%
  ggplot(aes(fct_rev(what_is_your_highest_qualification), n)) +
    geom_col(fill = "#6CABDD") +
    geom_text(aes(label = n), hjust = 1.2, color = "white") +
    coord_flip() +
    labs(title = "Highest Qualification of Respondents", x = NULL, y = "Count") +
    theme_minimal(base_family = "Inter")
```

## Gender Breakdown

```{r}
# 3. Gender Breakdown
gender_data <- survey_responses_today %>%
  drop_na(gender) %>%
  mutate(gender_recoded = recode_gender(gender)) %>%
  replace_na(list(gender_recoded = "Unable to recode"))
gender_data %>%
  count(gender_recoded) %>%
  set_names("Gender", "Count")
```


## Locations

Respondents listed the location of their primary residence. The map below shows their locations. 

```{r}
# 4. Locations Map
survey_responses_today <- survey_responses_today %>%
  rename(city_residence = what_is_the_city_of_your_primary_residence_please_enter_city_like_islamabad_jhelum_lahore)
respondent_locations <- survey_responses_today %>%
  drop_na(city_residence) %>%
  geocode(address = city_residence, method = "osm", quiet = FALSE) %>%
  filter(!is.na(lat) & !is.na(long)) %>%
  select(city_residence, long, lat)
leaflet(respondent_locations) %>% 
  addProviderTiles(providers$CartoDB.Positron) %>% 
  addCircleMarkers(~long, ~lat,
                   color = "#FF7400",
                   stroke = FALSE, 
                   fillOpacity = 0.7,
                   popup = ~city_residence,
                   clusterOptions = markerClusterOptions(showCoverageOnHover = FALSE))
```


## Familiarity with R/Python 


```{r}
# 5. Familiarity with R/Python
mean_familiarity <- round(mean(survey_responses_today$how_familiar_you_are_with_r_or_python, na.rm = TRUE), 1)
survey_responses_today %>%
  group_by(what_is_your_highest_qualification) %>%
  summarize(mean_familiarity = round(mean(how_familiar_you_are_with_r_or_python, na.rm = TRUE), 1)) %>%
  ggplot(aes(fct_rev(what_is_your_highest_qualification), mean_familiarity)) +
    geom_col(fill = "#6CABDD") +
    geom_text(aes(label = mean_familiarity), hjust = 1.2, color = "white") +
    coord_flip() +
    labs(title = "Familiarity with R/Python by Education Level", x = NULL, y = "Mean Familiarity") +
    theme_minimal(base_family = "Inter")
```

## Interest in Learning R/Python

```{r}
# 6. Interest in Learning R/Python
mean_interest <- round(mean(survey_responses_today$how_interested_are_you_in_learning_r_or_python, na.rm = TRUE), 1)
survey_responses_today %>%
  mutate(age_category = case_when(
    age < 30  ~ "Less than 30",
    age < 50  ~ "Between 30 and 50",
    TRUE      ~ "50 or older"
  )) %>%
  group_by(what_is_your_highest_qualification, age_category) %>%
  summarize(mean_interest = round(mean(how_interested_are_you_in_learning_r_or_python, na.rm = TRUE), 1)) %>%
  ggplot(aes(age_category, mean_interest, fill = what_is_your_highest_qualification)) +
    geom_col(position = "dodge") +
    labs(title = "Interest in Learning R/Python by Age and Education", x = NULL, y = "Mean Interest") +
    theme_minimal(base_family = "Inter")
```

## AI Usage & Productivity 

```{r}
# 7. AI Usage & Productivity
ai_productivity_impact <- survey_responses_today %>%
  drop_na(how_much_it_has_increased_your_productivity, do_you_use_chat_gpt_or_other_ai) %>%
  mutate(do_you_use_chat_gpt_or_other_ai = as.factor(do_you_use_chat_gpt_or_other_ai)) %>%
  group_by(do_you_use_chat_gpt_or_other_ai) %>%
  summarize(mean_productivity_increase = round(mean(how_much_it_has_increased_your_productivity, na.rm = TRUE), 1)) %>%
  ungroup()
ggplot(ai_productivity_impact, aes(x = do_you_use_chat_gpt_or_other_ai, y = mean_productivity_increase)) +
  geom_col(fill = "#6CABDD") +
  geom_text(aes(label = mean_productivity_increase), hjust = 1.2, color = "white") +
  coord_flip() +
  labs(title = "Productivity Increase Due to AI Usage", x = NULL, y = "Average Productivity Increase") +
  theme_minimal(base_family = "Inter")
```


## Faimiliarity with Tools

```{r}
# Familiarity with Excel Files
survey_responses_today %>%
  drop_na(how_familiar_you_are_with_excel_files) %>%
  count(how_familiar_you_are_with_excel_files) %>%
  mutate(level = factor(how_familiar_you_are_with_excel_files,
                        levels = 1:5,
                        labels = c("1 (Not at all)","2","3","4","5 (Expert)"))) %>%
  ggplot(aes(level, n)) +
    geom_col(fill = "#6CABDD") +
    geom_text(aes(label = n), vjust = -0.3) +
    labs(title = "Familiarity with Excel Files",
         x = "Rating",
         y = "Count") +
    theme_minimal(base_family = "Inter")
```

## Familiarity with Data Analysis Tools

```{r}
# Familiarity with Exploratory Data Analysis
survey_responses_today %>%
  drop_na(how_familiar_you_are_with_exploratory_data_analysis) %>%
  count(how_familiar_you_are_with_exploratory_data_analysis) %>%
  mutate(level = factor(how_familiar_you_are_with_exploratory_data_analysis,
                        levels = 1:5,
                        labels = c("1 (Not at all)","2","3","4","5 (Expert)"))) %>%
  ggplot(aes(level, n)) +
    geom_col(fill = "#6CABDD") +
    geom_text(aes(label = n), vjust = -0.3) +
    labs(title = "Familiarity with Exploratory Data Analysis",
         x = "Rating",
         y = "Count") +
    theme_minimal(base_family = "Inter")
```


## familiarity with Statistical Analysis Tools

```{r}
# Familiarity with Regression Analysis
survey_responses_today %>%
  drop_na(how_familiar_you_are_with_regression_analysis) %>%
  count(how_familiar_you_are_with_regression_analysis) %>%
  mutate(level = factor(how_familiar_you_are_with_regression_analysis,
                        levels = 1:5,
                        labels = c("1 (Not at all)","2","3","4","5 (Expert)"))) %>%
  ggplot(aes(level, n)) +
    geom_col(fill = "#6CABDD") +
    geom_text(aes(label = n), vjust = -0.3) +
    labs(title = "Familiarity with Regression Analysis",
         x = "Rating",
         y = "Count") +
    theme_minimal(base_family = "Inter")
```

## Research Design and Impact Evaluation Tools

```{r}
# Familiarity with Research Design
survey_responses_today %>%
  drop_na(how_familiar_you_are_with_research_design) %>%
  count(how_familiar_you_are_with_research_design) %>%
  mutate(level = factor(how_familiar_you_are_with_research_design,
                        levels = 1:5,
                        labels = c("1 (Not at all)","2","3","4","5 (Expert)"))) %>%
  ggplot(aes(level, n)) +
    geom_col(fill = "#6CABDD") +
    geom_text(aes(label = n), vjust = -0.3) +
    labs(title = "Familiarity with Research Design",
         x = "Rating",
         y = "Count") +
    theme_minimal(base_family = "Inter")
```

```{r}
# Familiarity with Impact Evaluation Tools
survey_responses_today %>%
  drop_na(how_familiar_you_are_with_impact_evaluation_tools) %>%
  count(how_familiar_you_are_with_impact_evaluation_tools) %>%
  mutate(level = factor(how_familiar_you_are_with_impact_evaluation_tools,
                        levels = 1:5,
                        labels = c("1 (Not at all)","2","3","4","5 (Expert)"))) %>%
  ggplot(aes(level, n)) +
    geom_col(fill = "#6CABDD") +
    geom_text(aes(label = n), vjust = -0.3) +
    labs(title = "Familiarity with Impact Evaluation Tools",
         x = "Rating",
         y = "Count") +
    theme_minimal(base_family = "Inter")
```

```{r}
# Familiarity with CSV Files
survey_responses_today %>%
  drop_na(how_familiar_you_are_with_csv_files) %>%
  count(how_familiar_you_are_with_csv_files) %>%
  mutate(level = factor(how_familiar_you_are_with_csv_files,
                        levels = 1:5,
                        labels = c("1 (Not at all)","2","3","4","5 (Expert)"))) %>%
  ggplot(aes(level, n)) +
    geom_col(fill = "#6CABDD") +
    geom_text(aes(label = n), vjust = -0.3) +
    labs(title = "Familiarity with CSV Files",
         x = "Rating",
         y = "Count") +
    theme_minimal(base_family = "Inter")
```
